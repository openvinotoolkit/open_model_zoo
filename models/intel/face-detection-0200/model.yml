# Copyright (c) 2021 Intel Corporation
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.

description: >-
  Face detector based on MobileNetV2 as a backbone with a multiple SSD head for indoor
  and outdoor scenes shot by a front-facing camera. During the training of this model,
  training images were resized to 256x256.
task_type: detection
files:
  - name: model/export.py
    size: 1526
    sha256: 24dd06701d54feec4e4c5f8a81ad0b0c956cd99e07ea6857fb0c71083a8bdc9d
    source: https://raw.githubusercontent.com/openvinotoolkit/training_extensions/develop/ote/tools/export.py
  # configuration of model
  - name: model/modules.yaml
    size: 214
    sha256: 6ef37f55b166bf55f4cf91f270cf4ed293501d2f4c5a95158b0e5c6321e7a44c
    source: https://raw.githubusercontent.com/openvinotoolkit/training_extensions/develop/models/object_detection/model_templates/face-detection/face-detection-0200/modules.yaml
  - name: model/template.yaml
    size: 1982
    sha256: 5b0f0947e3b1986788d6838d5854aadb8d9f74df9e26bc0f9df451df18152319
    source: https://raw.githubusercontent.com/openvinotoolkit/training_extensions/develop/models/object_detection/model_templates/face-detection/face-detection-0200/template.yaml
  - name: model/model.py
    size: 4348
    sha256: e8a13d959ad9c3c8c2efa1c33c905e62c6cea0862a48b7f8cbb6892efaed23b4
    source: https://raw.githubusercontent.com/openvinotoolkit/training_extensions/develop/models/object_detection/model_templates/face-detection/face-detection-0200/model.py
  # ote lib
  - name: model/ote/__init__.py
    size: 745
    sha256: cee512a1827e8ee4edd26ef4c12c20aebd0bd9a4824aea4bbf0035d6ec2a3db3
    source: https://raw.githubusercontent.com/openvinotoolkit/training_extensions/develop/ote/ote/__init__.py
  - name: model/ote/api.py
    size: 7373
    sha256: a4b1ab8105f7550fe9ece40ec1b749e6fd1429c90ddf9f55603aac6f37fad47a
    source: https://raw.githubusercontent.com/openvinotoolkit/training_extensions/develop/ote/ote/api.py
  - name: model/ote/modules/__init__.py
    size: 2201
    sha256: ef5a895ec029a6caca140d3eca5d1e4f342409864514a778e418455a282dab4b
    source: https://raw.githubusercontent.com/openvinotoolkit/training_extensions/develop/ote/ote/modules/__init__.py
  - name: model/ote/modules/registry.py
    size: 850
    sha256: 0ee49715a752e7498604225590d9b350005d1b8fcd3938ed9eb76f55d758dc51
    source: https://raw.githubusercontent.com/openvinotoolkit/training_extensions/develop/ote/ote/modules/registry.py
  - name: model/ote/modules/builder.py
    size: 1783
    sha256: 4393691a5b4014c21c16198136ef161eb63a01430d3b90a937f3a57daef0b6e6
    source: https://raw.githubusercontent.com/openvinotoolkit/training_extensions/develop/ote/ote/modules/builder.py
  - name: model/ote/modules/arg_converters/__init__.py
    size: 481
    sha256: 3e6f38a06d9707003802a5fd1fa90872dcbb439a598c40ee0a7cfb0bf77e619a
    source: https://raw.githubusercontent.com/openvinotoolkit/training_extensions/develop/ote/ote/modules/arg_converters/__init__.py
  - name: model/ote/modules/arg_converters/base.py
    size: 10592
    sha256: 3115ff461e4182d3dbef8d19e34fea6f6e6c539aa32a39a2a342c2f93e3d5f0c
    source: https://raw.githubusercontent.com/openvinotoolkit/training_extensions/develop/ote/ote/modules/arg_converters/base.py
  - name: model/ote/modules/arg_converters/mmdetection.py
    size: 6646
    sha256: 88b8a3f1bc2386830eaf842ac922e1dc96adf56cc468b8e08d2bc8211b27816c
    source: https://raw.githubusercontent.com/openvinotoolkit/training_extensions/develop/ote/ote/modules/arg_converters/mmdetection.py
  - name: model/ote/modules/arg_converters/face_detection.py
    size: 958
    sha256: 5ab16290c8d8ece6572c368c887f9ab8bd620e39207ca069d93d87f6b648f704
    source: https://raw.githubusercontent.com/openvinotoolkit/training_extensions/develop/ote/ote/modules/arg_converters/face_detection.py
  - name: model/ote/modules/arg_parsers/__init__.py
    size: 289
    sha256: b83178e4ce2a06d66e5ca402f50bb50e2d8509a966656e42ebf1a970bb7d107c
    source: https://raw.githubusercontent.com/openvinotoolkit/training_extensions/develop/ote/ote/modules/arg_parsers/__init__.py
  - name: model/ote/modules/arg_parsers/face_detector.py
    size: 1121
    sha256: bd7046349fa6b35cbe989228dd343646bc8b310caf87b06ac35c478ee28374b9
    source: https://raw.githubusercontent.com/openvinotoolkit/training_extensions/develop/ote/ote/modules/arg_parsers/face_detector.py
  - name: model/ote/modules/arg_parsers/default.py
    size: 1221
    sha256: a7b4a6716dcb50e919b4593212fc652a53619fb94922605559ee16b66b82e6ba
    source: https://raw.githubusercontent.com/openvinotoolkit/training_extensions/develop/ote/ote/modules/arg_parsers/default.py
  - name: model/ote/modules/exporters/__init__.py
    size: 426
    sha256: 02ce06f438edcd6b54516ac72174e34b71c42bd8d6f685e9c8708fe9ad6fd3bc
    source: https://raw.githubusercontent.com/openvinotoolkit/training_extensions/develop/ote/ote/modules/exporters/__init__.py
  - name: model/ote/modules/exporters/base.py
    size: 1769
    sha256: 1ef0d18a7acaa04b248fb88c3e13a7fce95d89f3072d4e75ab7e122d1a419ebc
    source: https://raw.githubusercontent.com/openvinotoolkit/training_extensions/develop/ote/ote/modules/exporters/base.py
  - name: model/ote/modules/exporters/mmdetection.py
    size: 4758
    sha256: 3e83fd510a256c33ced99624df79eae84db5f3264954ae70ad186aceee5ac98b
    source: https://raw.githubusercontent.com/openvinotoolkit/training_extensions/develop/ote/ote/modules/exporters/mmdetection.py
  - name: model/ote/utils/__init__.py
    size: 326
    sha256: 08d460f33866553146bbbb3eb7bb4385b56097391113568bc1be7e1d9f14c5b6
    source: https://raw.githubusercontent.com/openvinotoolkit/training_extensions/develop/ote/ote/utils/__init__.py
  - name: model/ote/utils/loaders.py
    size: 736
    sha256: f4a6d086bef21b578dfaf7feb6127b2273de71bfa95c47ce320f49298d4f355c
    source: https://raw.githubusercontent.com/openvinotoolkit/training_extensions/develop/ote/ote/utils/loaders.py
  - name: model/ote/utils/misc.py
    size: 6066
    sha256: ebc5c7134c281a48ca18e7096d366e4e15d07f401d5ce278f9d31464e326327e
    source: https://raw.githubusercontent.com/openvinotoolkit/training_extensions/develop/ote/ote/utils/misc.py
  - name: model/ote/utils/runners.py
    size: 2645
    sha256: 2014bedaf266477309bc8048106d6bf13bf5c191af1e6b3dea0b17e5e246ad01
    source: https://raw.githubusercontent.com/openvinotoolkit/training_extensions/develop/ote/ote/utils/runners.py
  # requirments libs
  - name: model/lib/addict-2.4.0-py3-none-any.whl
    size: 3832
    sha256: 249bb56bbfd3cdc2a004ea0ff4c2b6ddc84d53bc2194761636eb314d5cfa5dfc
    source: https://files.pythonhosted.org/packages/6a/00/b08f23b7d7e1e14ce01419a467b583edbb93c6cdb8654e54a9cc579cd61f/addict-2.4.0-py3-none-any.whl
  - name: model/lib/packaging-21.0-py3-none-any.whl
    size: 40357
    sha256: c86254f9220d55e31cc94d69bade760f0847da8000def4dfe1c6b872fd14ff14
    source: https://files.pythonhosted.org/packages/3c/77/e2362b676dc5008d81be423070dd9577fa03be5da2ba1105811900fda546/packaging-21.0-py3-none-any.whl
  - name: model/lib/terminaltables-3.1.0.tar.gz
    size: 12478
    sha256: f3eb0eb92e3833972ac36796293ca0906e998dc3be91fbe1f8615b331b853b81
    source: https://files.pythonhosted.org/packages/9b/c4/4a21174f32f8a7e1104798c445dacdc1d4df86f2f26722767034e4de4bff/terminaltables-3.1.0.tar.gz
  - name: model/lib/mmcv-full-1.3.0.tar.gz
    size: 253880
    sha256: 4103a74604c06b51dae82b96d6d796336aa6c5c38b68235e64b412f9154a901b
    source: https://files.pythonhosted.org/packages/9b/d1/6201ac4b55cd5252a35c9890b65d7629629ca37eed09a072dcbfc96a2817/mmcv-full-1.3.0.tar.gz
  - name: model/lib/mmdetection.zip
    size: 7741695
    sha256: 27a96172f28349ff199eb1393dcb8623c621dbe94213ebe5ea17a1a64a2bcd83
    source: https://github.com/openvinotoolkit/mmdetection/archive/4856591efb5c60a1380e574a6c7f8566a9b31dfe.zip
  - name: model/lib/pytorchcv-0.0.55-py2.py3-none-any.whl
    size: 390793
    sha256: 7093a5ba90080f2b20606db34a44d3c1416c716926ffeeb9f7f52133b6284b5b
    source: https://files.pythonhosted.org/packages/a3/66/c8a8bc74e7d5434238c07e083e65212dd1eae10eefa2409285f8aefc1432/pytorchcv-0.0.55-py2.py3-none-any.whl
  # weights
  - name: model/ckpt/snapshot.pth
    size: 14904296
    sha256: 122e194b95ef631f578fac0dc88ba2be7b2ef9d06263ff6e7a69c846990a85f7
    source: https://download.01.org/opencv/openvino_training_extensions/models/object_detection/v2/face-detection-0200.pth
postprocessing:
  - $type: unpack_archive
    format: zip
    file: model/lib/addict-2.4.0-py3-none-any.whl
  - $type: unpack_archive
    format: zip
    file: model/lib/pytorchcv-0.0.55-py2.py3-none-any.whl
  - $type: unpack_archive
    format: zip
    file: model/lib/packaging-21.0-py3-none-any.whl
  - $type: unpack_archive
    format: gztar
    file: model/lib/mmcv-full-1.3.0.tar.gz
  - $type: unpack_archive
    format: gztar
    file: model/lib/terminaltables-3.1.0.tar.gz
  - $type: unpack_archive
    format: zip
    file: model/lib/mmdetection.zip

  - $type: regex_replace
    pattern: 'openvino:\n    default: true'
    replacement: 'openvino:\n    default: false'
    file: model/template.yaml
  - $type: regex_replace
    pattern: 'from yapf'
    replacement: '# \g<0>'
    file: model/lib/mmcv-full-1.3.0/mmcv/utils/config.py
  - $type: regex_replace
    pattern: 'from \.(custom_classes|reid)'
    replacement: '# \g<0>'
    file: model/ote/modules/arg_parsers/__init__.py
  - $type: regex_replace
    pattern: 'from \.(mmaction|reid)'
    replacement: '# \g<0>'
    file: model/ote/modules/arg_converters/__init__.py
  - $type: regex_replace
    pattern: 'from \.(mmaction|instance_segmentation|reid)'
    replacement: '# \g<0>'
    file: model/ote/modules/exporters/__init__.py
  - $type: regex_replace
    pattern: 'from ote.modules.compression'
    replacement: '# \g<0>'
    file: model/export.py
  - $type: regex_replace
    pattern: 'if modules\.get\(''compression''\)(.*):\n.*\n.*'
    replacement: ''
    file: model/export.py
  - $type: regex_replace
    pattern: '\.\.\/\.\.\/\.\.\/external\/mmdetection'
    replacement: '../lib/mmdetection-4856591efb5c60a1380e574a6c7f8566a9b31dfe'
    file: model/ote/__init__.py
  - $type: regex_replace
    pattern: 'from \.(compression|trainers) import(.*)|from \.evaluators import [^\)]*.'
    replacement: ''
    file: model/ote/modules/__init__.py
  - $type: regex_replace
    pattern: ',[^\w]*(CustomClassesArg|InstanceSegmentation|MMAction|Reid)[^(,|\)|\n)]*'
    replacement: ''
    file: model/ote/modules/__init__.py
  - $type: regex_replace
    pattern: '.*_requires?='
    replacement: '# \g<0>'
    file: model/lib/mmcv-full-1.3.0/setup.py
  - $type: regex_replace
    pattern: 'from onnxoptimizer|optimize_onnx_graph\(onnx_model_path\)\n'
    replacement: '# \g<0>'
    file: model/lib/mmdetection-4856591efb5c60a1380e574a6c7f8566a9b31dfe/tools/export.py
  - $type: regex_replace
    pattern: 'alt_ssd_export=is_alt_ssd_export'
    replacement: 'alt_ssd_export=True'
    file: model/lib/mmdetection-4856591efb5c60a1380e574a6c7f8566a9b31dfe/tools/export.py
  - $type: regex_replace
    pattern: 'if is_alt_ssd_export:\n.*?(patch_.*)'
    replacement: '\g<1>'
    file: model/lib/mmdetection-4856591efb5c60a1380e574a6c7f8566a9b31dfe/tools/export.py
  - $type: regex_replace
    pattern: '(from|import) (pycocotools|matplotlib|editdistance|tqdm|Polygon )'
    replacement: '# \g<0>'
    file: model/lib/mmdetection-4856591efb5c60a1380e574a6c7f8566a9b31dfe/mmdet/**/*.py
  - $type: regex_replace
    pattern: 'try(.|\n)*?except.*\n.*raise(.*?)\((.|\n)*?\)'
    replacement: ''
    file: model/lib/mmdetection-4856591efb5c60a1380e574a6c7f8566a9b31dfe/mmdet/datasets/coco.py
model_optimizer_args:
  - --input_shape=[1,3,256,256]
  - --reverse_input_channels
  - --mean_values=[0,0,0]
  - --scale_values=[255,255,255]
  - --input=image
  - --output=detection_out
  - --input_model=$conv_dir/model.onnx
framework: onnx
license: https://raw.githubusercontent.com/openvinotoolkit/training_extensions/develop/LICENSE
